(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{365:function(t,s,a){"use strict";a.r(s);var n=a(42),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"project"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#project"}},[t._v("#")]),t._v(" Project")]),t._v(" "),a("h2",{attrs:{id:"_1-项目概览"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-项目概览"}},[t._v("#")]),t._v(" 1. 项目概览")]),t._v(" "),a("h3",{attrs:{id:"_1-1-组件架构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-组件架构"}},[t._v("#")]),t._v(" 1.1 组件架构")]),t._v(" "),a("p",[a("img",{attrs:{src:"/imgs/comp_cons.png",alt:"image"}})]),t._v(" "),a("h3",{attrs:{id:"_1-2-组件逻辑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-组件逻辑"}},[t._v("#")]),t._v(" 1.2 组件逻辑")]),t._v(" "),a("p",[a("img",{attrs:{src:"/imgs/comp_logic.png",alt:"image"}})]),t._v(" "),a("h2",{attrs:{id:"_2-项目细节"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-项目细节"}},[t._v("#")]),t._v(" 2. 项目细节")]),t._v(" "),a("h3",{attrs:{id:"_2-1-我负责部分"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-我负责部分"}},[t._v("#")]),t._v(" 2.1 我负责部分")]),t._v(" "),a("ul",[a("li",[t._v("主页面的三个模块：车次、我的车票、个人中心\n"),a("ul",[a("li",[t._v("车次")]),t._v(" "),a("li",[t._v("我的车票：这里又有一个子路由，四个页面之间跳转")]),t._v(" "),a("li",[t._v("个人中心")]),t._v(" "),a("li",[t._v("以及网络请求模块")])])])]),t._v(" "),a("h3",{attrs:{id:"_2-2-一些小的亮点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-一些小的亮点"}},[t._v("#")]),t._v(" 2.2 一些小的亮点")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("路由懒加载：增加首屏的加载速度")]),t._v(" "),a("ul",[a("li",[t._v("将app.js拆分，多出几个js文件，也就是其他路由页面的js文件")])])]),t._v(" "),a("li",[a("p",[t._v("Vuex来管理 bus 的座位信息和 user 的 localStorage 中的 token")])]),t._v(" "),a("li",[a("p",[t._v("vh来实现了响应式的布局")])]),t._v(" "),a("li",[a("p",[t._v("导航守卫：（router.beforeEach）")]),t._v(" "),a("ul",[a("li",[t._v("来保证每次切换页面之前，都要检查是否已经登陆")]),t._v(" "),a("li",[t._v("如果是从「确认订单」的页面跳转回「车次信息」（选座位的页面），还要恢复之前已经选中的座位的被选中的状态")])])]),t._v(" "),a("li",[a("p",[t._v("封装、复用的思想：")]),t._v(" "),a("ul",[a("li",[t._v("比如 getOrder 这个获取订单的函数的复用，只需要根据参数不同，来获取不同的订单，不需要再写多个函数了。")]),t._v(" "),a("li",[t._v("订单详情页面的复用，已支付 / 未支付的订单用同一个组件，只是根据状态，下面是候车时间 / 前往支付")])])]),t._v(" "),a("li",[a("p",[t._v("跨域")]),t._v(" "),a("ul",[a("li",[t._v("vue的devServer.proxy")]),t._v(" "),a("li",[t._v("本身应该是来自于一个叫做 "),a("code",[t._v("http-proxy-middleware")]),t._v("的集成")]),t._v(" "),a("li",[t._v("参数中，开启了WebSocket，并且changeOrigin。")])]),t._v(" "),a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// vue.config.js")]),t._v("\ndevServer"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  proxy"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/apis'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      target"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://sb.dreamcat.ink:2020/'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        ws"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n          changeOrigin"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            pathRewrite"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n              "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'^/apis'")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("''")]),t._v("\n            "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])])]),t._v(" "),a("h2",{attrs:{id:"_3-难点与解决方案"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-难点与解决方案"}},[t._v("#")]),t._v(" 3. 难点与解决方案")]),t._v(" "),a("h3",{attrs:{id:"_3-1-css的布局与居中问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-css的布局与居中问题"}},[t._v("#")]),t._v(" 3.1 CSS的布局与居中问题")]),t._v(" "),a("ul",[a("li",[t._v("作为前端的新手，经常分不清 vertical-middle / text-align 之类的是什么作用")]),t._v(" "),a("li",[t._v("百分比完全分不清楚是根据谁的百分比")]),t._v(" "),a("li",[t._v("经常会写了样式，发现为什么不生效呢，或者生效了也不知道为什么")])]),t._v(" "),a("h3",{attrs:{id:"_3-2-前后端分离的业务逻辑问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-前后端分离的业务逻辑问题"}},[t._v("#")]),t._v(" 3.2 前后端分离的业务逻辑问题")]),t._v(" "),a("ul",[a("li",[t._v("一个任务，到底是前端做呢，还是交给后端做呢？")]),t._v(" "),a("li",[t._v("尽可能地分担后端的压力，并且减少网络上的流量：\n"),a("ul",[a("li",[t._v("这个思想跟缓存很接近（感叹，很多东西本质上都是想通的）")]),t._v(" "),a("li",[t._v("但是也不能什么都前端实现，客户端臃肿，发送的流量大，违背了初衷")]),t._v(" "),a("li",[t._v("比如：\n"),a("ul",[a("li",[t._v("注册时候的确认密码判断：没必要发给客户端，或者检查注册信息中是否有不合法的字符")]),t._v(" "),a("li",[t._v("登陆的时候要显示账号或密码错误，而不是很直白的账号不存在或者密码错误，数据库里面是用哈希算法存的摘要，做摘要这个几乎是不可逆的计算，所以一般网络上见到的只有重置密码，没有找回原密码。")])])])])])]),t._v(" "),a("h2",{attrs:{id:"_4-typescript重构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-typescript重构"}},[t._v("#")]),t._v(" 4. TypeScript重构")]),t._v(" "),a("h3",{attrs:{id:"_4-1-概览"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-1-概览"}},[t._v("#")]),t._v(" 4.1 概览")]),t._v(" "),a("ul",[a("li",[t._v("主要的页面已经基本能跑起来")])]),t._v(" "),a("h3",{attrs:{id:"_4-2-难点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-难点"}},[t._v("#")]),t._v(" 4.2 难点")]),t._v(" "),a("h4",{attrs:{id:"_4-2-1-ref的问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-1-ref的问题"}},[t._v("#")]),t._v(" 4.2.1 ref的问题")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("主要还是vue2.x对于ts的支持不是很好，比如用的比较多的vue-property-decorator是vue社区出品。（所以期待vue3.0的ts）")])]),t._v(" "),a("li",[a("p",[t._v("scroll绑定了ref属性，方便调用，但是typescript里面不支持直接获取ref属性，需要单独声明一个属性去调用它")]),t._v(" "),a("div",{staticClass:"language-typescript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-typescript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 1. 声明一个属性")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("YourComponent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  $refs"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    checkboxElement"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" HTMLFormElement\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("someMethod")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$refs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("checkboxElement"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("checked\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 2. 声明计算属性")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" Vue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Component"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" Ref "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'vue-property-decorator'")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" AnotherComponent "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@/path/to/another-component.vue'")]),t._v("\n\n@Component\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("export")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("default")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("YourComponent")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("extends")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  @"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Ref")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("readonly")]),t._v(" anotherComponent"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" AnotherComponent\n  @"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("Ref")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'aButton'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("readonly")]),t._v(" button"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" HTMLButtonElement\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 3. 使用vuevue-property-decorator提供的Ref属性")]),t._v("\n "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("get")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("refs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token builtin"}},[t._v("any")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("$refs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("refs")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("clildGreet"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("hello")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])]),t._v(" "),a("li",[a("p",[t._v("StackOverflow是真的靠谱！")])])]),t._v(" "),a("h4",{attrs:{id:"_4-2-2-项目比较庞大不知道怎么入手"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-2-2-项目比较庞大不知道怎么入手"}},[t._v("#")]),t._v(" 4.2.2 项目比较庞大不知道怎么入手")]),t._v(" "),a("ul",[a("li",[t._v("很低效的方式是对比法：跟别人的项目比较，看自己缺了什么配置，就补充什么配置，但其实项目不同，配置依赖等都不同")]),t._v(" "),a("li",[t._v("比较一目了然的方法是：跟着别人写的经验、或者官方文档去初始化一个新的项目：\n"),a("ul",[a("li",[t._v("一方面，可以了解TypeScript和Vue在初始化的时候是怎么结合起来的，便于理解和记忆怎么去配置，使二者合作")]),t._v(" "),a("li",[t._v("另一方面，保证项目中不会缺失一些配置，或者可以根据自己的需要去配置一些东西，而不是跟着别人的项目走，并且看到一大堆的配置文件还是云里雾里的。")])])]),t._v(" "),a("li",[t._v("因为是强类型，有时候确实是不确定一个数据的类型的时候，只能用any，但是总是用any的话，感觉就失去了使用typeScript的意义。为什么叫"),a("strong",[t._v("type")]),t._v("script，重点在 type")]),t._v(" "),a("li",[t._v("过程中我也学到了很多东西：\n"),a("ul",[a("li",[t._v("入口很重要，就有点像之前跟着网上的一个教程简单实现一个vue（这里要好好去看下vue的基本原理和那份代码）")]),t._v(" "),a("li",[t._v("将大的模块拆分成小的，这里也体现了封装、模块化、强内聚低耦合的优越性，最重要的是写注释极大提高了代码的可读性，便于维护。")]),t._v(" "),a("li",[t._v("先重构路由相关的几个主要展示的组件，然后再对于每个组件下的子组件及其相关的部分进行重构，包括网络请求和Vuex状态管理")])])])]),t._v(" "),a("h3",{attrs:{id:"_4-3-对于typescript的理解"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-3-对于typescript的理解"}},[t._v("#")]),t._v(" 4.3 对于TypeScript的理解")]),t._v(" "),a("ul",[a("li",[t._v("强类型语言，但仅仅是编程时候，或者说是提供了一种js下强类型的编程范式，但是也可以不遵守")]),t._v(" "),a("li",[t._v("因为最终ts的代码是被转化为es5的js代码，然后被浏览器执行的，所以非要说的话，其实本质上并没有发生改变")]),t._v(" "),a("li",[t._v("即使IDE/tsLint可以检查出ts中的语法错误，但仍然是可以执行的，这些都是由于TS基于JS，而JS的本质是弱类型语言以及JS的一些其他的特定，决定了运行时的一些效果。")]),t._v(" "),a("li",[t._v("重构代码的过程中，但是避免了在类型上出错，同时这种面向对象的编程思想，也增强了代码的可读性，对于大型项目而言降低了维护成本，虽然重构的时候ESLint搞得人很痛苦，并且至于性能还有待测试。")]),t._v(" "),a("li",[t._v("目前在第三方组件vant的引入上还是有点问题，组件引入了但是显示的其中嵌入的内容不正确。")])]),t._v(" "),a("h2",{attrs:{id:"_5-测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-测试"}},[t._v("#")]),t._v(" 5. 测试")]),t._v(" "),a("h3",{attrs:{id:"_5-1-灰盒测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-灰盒测试"}},[t._v("#")]),t._v(" 5.1 灰盒测试")]),t._v(" "),a("h4",{attrs:{id:"_5-1-1-概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-1-概念"}},[t._v("#")]),t._v(" 5.1.1 概念")]),t._v(" "),a("ul",[a("li",[t._v("Jest：一个JavaScript测试框架（或者说，一款比较主流的 JavaScript 测试运行器），支持Vue，提供简单易用的api，支持生成代码覆盖率报告\n"),a("ul",[a("li",[t._v("匹配器：toBe、toBeCloseTo、toEqual、toBeNull等")]),t._v(" "),a("li",[t._v("钩子函数：beforeAll、afterAll、beforeEach、afterEach")]),t._v(" "),a("li",[t._v("同步测试/异步测试")]),t._v(" "),a("li",[t._v("shallowMount/mount：\n"),a("ul",[a("li",[t._v("mount：计算机中指 挂载")]),t._v(" "),a("li",[t._v("shallowMount：渲染的子组件是假的，只mount了当前组件（可能单元测试应该用这个）")]),t._v(" "),a("li",[t._v("mount：完整的渲染（可能适合集成测试的时候使用）")])])])])]),t._v(" "),a("li",[t._v("vue-test-util：Vue Test Utils 是Vue.js 官方的单元测试实用工具库")]),t._v(" "),a("li",[t._v("babel：Jest不支持ES6语法，需要用babel转化一下")])]),t._v(" "),a("h4",{attrs:{id:"_5-1-2-测试内容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-2-测试内容"}},[t._v("#")]),t._v(" 5.1.2 测试内容")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("主要测试了"),a("strong",[t._v("登陆模块")])])]),t._v(" "),a("li",[a("p",[t._v("同步测试")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("主要是测试了一些组件生成之后内容是否对应")])]),t._v(" "),a("li",[a("p",[t._v("因为组件本身比较简单，所以就相当于操作了一些怎么写测试。")])]),t._v(" "),a("li",[a("p",[t._v("示例代码")])]),t._v(" "),a("li",[a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ./src/components/hello-world/hello-world.spec.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" shallowMount "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@vue/test-utils'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" tabBar "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./tabBar'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("describe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<tab-bar/>'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" wrapper "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("shallowMount")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("tabBar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("it")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'should render correct contents'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("expect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wrapper"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'h1'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("isVisible")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toBe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])])]),t._v(" "),a("li",[a("p",[t._v("异步测试")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("mock掉原有的网络请求模块：比如"),a("code",[t._v("jest.mock('../../apis/user');")])])]),t._v(" "),a("li",[a("p",[t._v("然后 shallowMount 现有的组件，调用mock下的原本的网络请求函数")])]),t._v(" "),a("li",[a("p",[t._v("返回预设好的值，判断是否通过用例")])]),t._v(" "),a("li",[a("p",[t._v("示例代码：")])]),t._v(" "),a("li",[a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// ./src/components/user-info/user-info.spec.js")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" shallowMount "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'@vue/test-utils'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" UserInfo "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'./user-info'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("import")]),t._v(" UserApi "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("from")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../../apis/user'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// mock 掉 user 模块")]),t._v("\njest"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mock")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'../../apis/user'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 指定 getUserInfo 方法返回假数据")]),t._v("\nUserApi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getUserInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mockResolvedValue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  name"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'olive'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  desc"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'software engineer'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("describe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'<user-info/>'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" wrapper "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("shallowMount")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UserInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("test")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'getUserInfo 有且只 call 了一次'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("expect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("UserApi"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("getUserInfo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("mock"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("calls"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("length"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toBe")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("it")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'用户信息渲染正确'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("expect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wrapper"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.name'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("text")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toEqual")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'olive'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("expect")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("wrapper"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("find")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'.desc'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("text")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("toEqual")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'software engineer'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n")])])])])])]),t._v(" "),a("li",[a("p",[t._v("快照测试")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("SnapShot")])]),t._v(" "),a("li",[a("p",[t._v("第一次运行快照测试时会生成一个快照文件。")])]),t._v(" "),a("li",[a("p",[t._v("之后每次执行测试的时候，会生成一个快照，然后对比最初生成的快照文件:")]),t._v(" "),a("ul",[a("li",[t._v("如果没有发生改变，则通过测试。")]),t._v(" "),a("li",[t._v("否则测试不通过，同时会输出结果，对比不匹配的地方。")])])]),t._v(" "),a("li",[a("div",{staticClass:"language-javascript extra-class"},[a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[t._v("Test Suites"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" passed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" total\nTests"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" passed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" total\nSnapshots"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" passed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" total\nTime"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("        "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("s\nRan all test suites"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\nDone "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("in")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1.02")]),t._v("s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\n")])])])])])])]),t._v(" "),a("h4",{attrs:{id:"_5-1-3-遇到的困难"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-3-遇到的困难"}},[t._v("#")]),t._v(" 5.1.3 遇到的困难")]),t._v(" "),a("ul",[a("li",[t._v("主要还是因为项目比较小，不能够很好地体现使用工具进行自动化测试的优秀之处。")]),t._v(" "),a("li",[t._v("当然，实践之后总还是有一些体会：一旦项目比较大了，就没办法只是通过人工测试、或者手工输入一个一个的用例")])]),t._v(" "),a("h4",{attrs:{id:"_5-1-3-代码覆盖率"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-3-代码覆盖率"}},[t._v("#")]),t._v(" 5.1.3 代码覆盖率")]),t._v(" "),a("ul",[a("li",[t._v("概念：简单来说，就是 被测试执行的代码的数量 / 代码总数量")]),t._v(" "),a("li",[t._v("对于覆盖率的思考：\n"),a("ul",[a("li",[t._v("是一个辩证看待的指标：\n"),a("ul",[a("li",[t._v("代码覆盖并不等于测试质量、代码质量，甚至有可能测试用例本身就是错误的")]),t._v(" "),a("li",[t._v("但是反过来，覆盖率低，代码质量可能就不一定会很好。")])])]),t._v(" "),a("li",[t._v("不必强求100%覆盖率：\n"),a("ul",[a("li",[t._v("有个边际效用递减问题，为了追求数字上的完美，你可能要付出过多的代价，得不偿失，还不如省下点力气花在其它地方。")]),t._v(" "),a("li",[t._v("达到固然可嘉，但是随着项目的增大，达到100%覆盖的代价很大，有时候项目需要尽快上线盈利，可能就没有足够的时间测试所有的模块，只能先测试最核心、最重要的部分。（主要的业务功能要能够正常执行）")])])]),t._v(" "),a("li",[t._v("当然这里只是很笼统地说覆盖，详细的也分为：语句覆盖、判定覆盖、条件覆盖、路径覆盖")])])])]),t._v(" "),a("h4",{attrs:{id:"_5-1-4-个人的思考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-1-4-个人的思考"}},[t._v("#")]),t._v(" 5.1.4 个人的思考")]),t._v(" "),a("ul",[a("li",[t._v("前言：其实最开始是打算做性能测试的，结果学习到后面这个测试工具，更像是专门用来做单元测试、集成测试的，主要是来测试功能而不是性能。")]),t._v(" "),a("li",[t._v("很像是灰盒测试，其"),a("strong",[t._v("核心是通关断言的方式")]),t._v("来测试输入输出是否正确匹配，即是否完成了指定的功能。同时，生成的覆盖率报告又涉及到了白盒测试的思想，它会检查有哪些分支覆盖了。")]),t._v(" "),a("li",[t._v("为什么要做测试？因为现学前端，短期内不光要掌握前端各方面的基础知识，同时如果还需要脱颖而出，就需要一些亮点，而我的想法是做一些折腾的事情、剑走偏锋，当然毕竟是现学，基础薄弱的这个弱点还是没办法掩盖的，但是我还是比较希望尽可能从这个项目中展现我的能力和思路。")])]),t._v(" "),a("h3",{attrs:{id:"_5-2-性能测试"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-2-性能测试"}},[t._v("#")]),t._v(" 5.2 性能测试")]),t._v(" "),a("h2",{attrs:{id:"_6-优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-优化"}},[t._v("#")]),t._v(" 6. 优化")]),t._v(" "),a("ul",[a("li",[a("strong",[t._v("其实最大的问题还是做的比较泛，都是浅尝辄止，没有针对哪一个方向深入下去。有自身原因，也有客观原因。")])]),t._v(" "),a("li",[a("strong",[t._v("或者说，策略是：先将基本的能够优化的部分做了，然后再把某个方向做到极致，就类似于，九门课，先都保证能够考及格，然后再考虑把某一门课加强，甚至是做到考满分。")])])]),t._v(" "),a("h3",{attrs:{id:"_6-1-性能优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-性能优化"}},[t._v("#")]),t._v(" 6.1 性能优化")]),t._v(" "),a("h4",{attrs:{id:"_6-1-1-班车项目"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-1-班车项目"}},[t._v("#")]),t._v(" 6.1.1 班车项目")]),t._v(" "),a("table",[a("thead",[a("tr",[a("th",{staticStyle:{"text-align":"center"}},[t._v("优化"),a("br"),t._v("方法")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("打包"),a("br"),t._v("时间")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("打包"),a("br"),t._v("体积")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("DOM-Content-Loaded")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("Load")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("app.js")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("chunk-vendors.js")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("初始"),a("br"),t._v("页面")]),t._v(" "),a("th",{staticStyle:{"text-align":"center"}},[t._v("登陆"),a("br"),t._v("下单")])])]),t._v(" "),a("tbody",[a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("全优化")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("6.83s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("strong",[t._v("928kB")])]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("0.97s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("1.33s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("305kB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("1.4MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("2.5MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("strong",[t._v("4.2MB")])])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("无优化")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("7.54s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("2.8MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("1.02s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("1.45s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("306kB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("2.6MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("3.6MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("5.3MB")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("代码丑化")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("9.94s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("strong",[t._v("1.0MB")])]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("0.97s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("1.32s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("396kB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("2.5MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("3.5MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("5.1MB")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("cdn")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("strong",[t._v("5.07s")])]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("2.1MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("1.08s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("1.34s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("306kB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("1.4MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("2.5MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("4.3MB")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[a("strong",[t._v("无")]),t._v("路由懒加载")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("8.99s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("2.4MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("strong",[t._v("1.67s")])]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("strong",[t._v("2.01s")])]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("strong",[t._v("1.7MB")])]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("strong",[t._v("3.4MB")])]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[a("strong",[t._v("5.1MB")])]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("5.1MB")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("vant按需引入")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("6.23s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("2.8MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("0.95s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("1.38s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("306kB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("2.5MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("3.5MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("5.1MB")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("代码优化")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("7.48s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("2.8MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("0.95s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("1.38s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("306kB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("2.5MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("3.5MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("5.1MB")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("无图片懒加载*")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("9.95s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("1.7MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("0.86s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("2.41s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("246kB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("2.4MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("6.4MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("N/A")])]),t._v(" "),a("tr",[a("td",{staticStyle:{"text-align":"center"}},[t._v("图片懒加载*")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("9.93s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("1.7MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("1.05s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("2.04s")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("247kB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("2.5MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("4.6MB")]),t._v(" "),a("td",{staticStyle:{"text-align":"center"}},[t._v("N/A")])])])]),t._v(" "),a("ul",[a("li",[t._v("备注：\n"),a("ul",[a("li",[t._v("代码层面的优化：\n"),a("ul",[a("li",[t._v("冗余的div、无用的空格、换行符、注释。")]),t._v(" "),a("li",[t._v("引入但未被使用的组件、变量")]),t._v(" "),a("li",[t._v("文件命名规范、语义化")]),t._v(" "),a("li",[t._v("代码风格：分号、驼峰变量命名、缩进")])])]),t._v(" "),a("li",[t._v("概念：\n"),a("ul",[a("li",[t._v("chunk-venders.js是引用的第三方库的代码")]),t._v(" "),a("li",[t._v("app.js是开发者自己写的代码")])])])])]),t._v(" "),a("li",[t._v("疑问：\n"),a("ul",[a("li",[t._v("丑化后的dist只有1.0MB，但是初始页面仍然是3.5MB的大小")]),t._v(" "),a("li",[t._v("uglify没有完善的程序流分析。它可以简单的判断变量后续是否被引用、修改，但是不能判断一个变量完整的修改过程，不知道它是否已经指向了外部变量，所以很多有可能会产生副作用的代码，都只能保守的不删除。")])])])]),t._v(" "),a("h4",{attrs:{id:"_6-1-2-内存泄漏检查"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-1-2-内存泄漏检查"}},[t._v("#")]),t._v(" 6.1.2 内存泄漏检查")]),t._v(" "),a("ul",[a("li",[a("p",[t._v("理论上，内存泄漏的原因：")]),t._v(" "),a("ul",[a("li",[t._v("未被销毁的DOM事件监听")]),t._v(" "),a("li",[t._v("全局变量")]),t._v(" "),a("li",[t._v("脱离DOM的引用")]),t._v(" "),a("li",[t._v("闭包")]),t._v(" "),a("li",[t._v("计时器或者回调函数")])])]),t._v(" "),a("li",[a("p",[t._v("时间线测试：")])]),t._v(" "),a("li",[a("p",[t._v("初步测试（5分钟，切换了两次账号）")])])]),t._v(" "),a("p",[a("img",{attrs:{src:"/imgs/leak-line1.png",alt:"image"}})]),t._v(" "),a("ul",[a("li",[t._v("再次测试（9分钟，切换了五次账号）")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/imgs/leak-line2.png",alt:"image"}})]),t._v(" "),a("ul",[a("li",[a("p",[t._v("快照测试")])]),t._v(" "),a("li",[a("p",[t._v("概览")])])]),t._v(" "),a("p",[a("img",{attrs:{src:"/imgs/leak1.png",alt:"image"}})]),t._v(" "),a("ul",[a("li",[t._v("看得出来似乎还是有一些内存泄漏的，打开比较模式，并且意外在每个快照对比上一个快照的时候，都产生了新的闭包")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/imgs/leak2.png",alt:"image"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"/imgs/leak3.png",alt:"image"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"/imgs/leak4.png",alt:"image"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"/imgs/leak5.png",alt:"image"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"/imgs/leak6.png",alt:"image"}})]),t._v(" "),a("ul",[a("li",[t._v("查看闭包之前，先看看这个占用新增的内存的大头array里面都有什么")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/imgs/leak7.png",alt:"image"}})]),t._v(" "),a("p",[t._v("接着，再来仔细看看闭包的内容")]),t._v(" "),a("p",[a("img",{attrs:{src:"/imgs/leak8.png",alt:"image"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"/imgs/leak9.png",alt:"image"}})]),t._v(" "),a("p",[a("img",{attrs:{src:"/imgs/leak10.png",alt:"image"}})]),t._v(" "),a("ul",[a("li",[t._v("关闭比较模式，来看一下快照本身的元素")])]),t._v(" "),a("p",[a("img",{attrs:{src:"/imgs/leak11.png",alt:"image"}})]),t._v(" "),a("h3",{attrs:{id:"_6-2-用户友好性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_6-2-用户友好性"}},[t._v("#")]),t._v(" 6.2 用户友好性")]),t._v(" "),a("ul",[a("li",[t._v("Toast 淡入淡出的效果")]),t._v(" "),a("li",[t._v("Loading加载组件")]),t._v(" "),a("li",[t._v("骨架图组件")])]),t._v(" "),a("h2",{attrs:{id:"_7-还可以改进的地方"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-还可以改进的地方"}},[t._v("#")]),t._v(" 7. 还可以改进的地方")]),t._v(" "),a("h3",{attrs:{id:"_7-1-用户友好性"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-1-用户友好性"}},[t._v("#")]),t._v(" 7.1 用户友好性")]),t._v(" "),a("ul",[a("li",[t._v("下拉的时候「加载中」的提示，悬停半秒钟，然后显示加载成功。而不是直接就滑回上面去了。")]),t._v(" "),a("li",[t._v("toast的淡入淡出效果")]),t._v(" "),a("li",[t._v("及时的反馈：登陆/注册  成功/失败的时候给一个toast提示")]),t._v(" "),a("li",[t._v("keep-alive只能保证不重新加载，但是如果一个页面比较长，还需要在 actived / deactivated 的钩子函数里面保存scroll的位置")])]),t._v(" "),a("h3",{attrs:{id:"_7-2-文档"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-2-文档"}},[t._v("#")]),t._v(" 7.2 文档")]),t._v(" "),a("ul",[a("li",[t._v("开发模式基本上算是瀑布模型")]),t._v(" "),a("li",[t._v("印象里这种模型是文档驱动的，需要保证每一步都稳健，防止在后期出现严重的需求错误/设计错误。")])]),t._v(" "),a("h3",{attrs:{id:"_7-4-安全"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_7-4-安全"}},[t._v("#")]),t._v(" 7.4 安全")]),t._v(" "),a("ul",[a("li",[t._v("XSS攻击，并没有在提交的时候对于提交的内容进行审查，查看是否包含了字符串形式的脚本文件。")]),t._v(" "),a("li",[t._v("CSRF攻击，虽然是服务器，但是没有做 - -")])]),t._v(" "),a("h2",{attrs:{id:"_8-插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-插件"}},[t._v("#")]),t._v(" 8. 插件")]),t._v(" "),a("h3",{attrs:{id:"_8-1-betterscroll"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-1-betterscroll"}},[t._v("#")]),t._v(" 8.1 BetterScroll")]),t._v(" "),a("h3",{attrs:{id:"_8-2-fastclick"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_8-2-fastclick"}},[t._v("#")]),t._v(" 8.2 FastClick")])])}),[],!1,null,null,null);s.default=e.exports}}]);